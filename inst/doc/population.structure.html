<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Eric Archer" />

<meta name="date" content="2020-02-23" />

<title>Tests of population structure</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Tests of population structure</h1>
<h4 class="author">Eric Archer</h4>
<h4 class="date">2020-02-23</h4>



<p>Given some sample microsatellite data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">data</span>(msats.g)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">msats &lt;-<span class="st"> </span><span class="kw">stratify</span>(msats.g, <span class="st">&quot;fine&quot;</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">msats &lt;-<span class="st"> </span>msats[, <span class="kw">getLociNames</span>(msats)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], ]</a></code></pre></div>
<p>There are several ways that population structure analyses can be conducted. For each population structure metric, there is a function starting with “stat” (e.g., <em>statFst</em>, <em>statChi2</em>, <em>statGst</em>). A full list can be found in <em>?popStructStat</em>.</p>
<p>Each of these functions takes a gtypes object and produces a list which contains the name of the statistic, the value of the estimate, the permutation p-value (based on 1000 replicates by default), and if <code>keep.null = TRUE</code>, the permutation null distribution:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">statFst</span>(msats)</a></code></pre></div>
<pre><code>## $stat.name
## [1] &quot;Fst&quot;
## 
## $result
## estimate    p.val 
##     0.11       NA 
## 
## $null.dist
## NULL</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">statGst</span>(msats, <span class="dt">nrep =</span> <span class="dv">10</span>, <span class="dt">keep.null =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## $stat.name
## [1] &quot;Gst&quot;
## 
## $result
## estimate    p.val 
##    0.061    0.091 
## 
## $null.dist
##  [1] -0.00541 -0.00163 -0.00101 -0.00194 -0.00209 -0.00525 -0.00239 -0.00161
##  [9]  0.00056 -0.00084</code></pre>
<p>Population structure tests can be conducted in an “overall” manner which estimates the degree of differentiation due to the specified stratification scheme, or in a “pairwise” manner, which tests differentiation between all pairs of strata. The overall test is run via <em>overallTest()</em>. By default, all statistics are run and NAs are returned if they are not appropriate to the type of data (e.g., PHIst for diploid data). Tests for specified statistics can be conducted by listing them in the <code>stats</code> argument:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">ovl &lt;-<span class="st"> </span><span class="kw">overallTest</span>(msats, <span class="dt">stats =</span> <span class="kw">c</span>(<span class="st">&quot;fst&quot;</span>, <span class="st">&quot;chi2&quot;</span>), <span class="dt">nrep =</span> <span class="dv">1000</span>)</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; dolphin msats &gt;&gt;&gt;
##  2020-02-23 16:30:27 : Overall test : 1000 permutations
## 
##                 N
## Coastal        68
## Offshore.North 40
## Offshore.South 18
## 
## Population structure results:
##      estimate p.val
## Fst      0.11 0.001
## Chi2   568.71 0.001</code></pre>
<p>Pairwise tests are conducted with <em>pairwiseTest()</em> in a similar fashion.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">pws &lt;-<span class="st"> </span><span class="kw">pairwiseTest</span>(msats, <span class="dt">stats =</span> <span class="kw">c</span>(<span class="st">&quot;fst.prime&quot;</span>, <span class="st">&quot;gst&quot;</span>), <span class="dt">nrep =</span> <span class="dv">1000</span>)</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; dolphin msats &gt;&gt;&gt;
##  2020-02-23 16:30:27 : Pairwise tests : 1000 permutations
##    2020-02-23 16:30:27 : Coastal v. Offshore.North 
##    2020-02-23 16:30:27 : Coastal v. Offshore.South 
##    2020-02-23 16:30:28 : Offshore.North v. Offshore.South 
## 
## Population structure results:
##                                               F'st F'st.p.val      Gst
## Coastal (68) v. Offshore.North (40)         0.5117      0.001  0.06713
## Coastal (68) v. Offshore.South (18)         0.5902      0.001  0.07613
## Offshore.North (40) v. Offshore.South (18) -0.0099      0.558 -0.00054
##                                            Gst.p.val
## Coastal (68) v. Offshore.North (40)            0.001
## Coastal (68) v. Offshore.South (18)            0.001
## Offshore.North (40) v. Offshore.South (18)     0.539</code></pre>
<p>The result of a pairwise test contains both a data.frame formatted for each pairwise comparison and pairwise matrices for each statistic with statistic estimates in the lower left, and p-values in the upper right.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">pws</a></code></pre></div>
<pre><code>## $result
##                                                  strata.1       strata.2 n.1
## Coastal (68) v. Offshore.North (40)               Coastal Offshore.North  68
## Coastal (68) v. Offshore.South (18)               Coastal Offshore.South  68
## Offshore.North (40) v. Offshore.South (18) Offshore.North Offshore.South  40
##                                            n.2    F'st F'st.p.val      Gst
## Coastal (68) v. Offshore.North (40)         40  0.5117      0.001  0.06713
## Coastal (68) v. Offshore.South (18)         18  0.5902      0.001  0.07613
## Offshore.North (40) v. Offshore.South (18)  18 -0.0099      0.558 -0.00054
##                                            Gst.p.val
## Coastal (68) v. Offshore.North (40)            0.001
## Coastal (68) v. Offshore.South (18)            0.001
## Offshore.North (40) v. Offshore.South (18)     0.539
## 
## $pair.mat
## $pair.mat$`F'st`
##                Coastal Offshore.North Offshore.South
## Coastal             NA         0.0010          0.001
## Offshore.North    0.51             NA          0.558
## Offshore.South    0.59        -0.0099             NA
## 
## $pair.mat$Gst
##                Coastal Offshore.North Offshore.South
## Coastal             NA        0.00100          0.001
## Offshore.North   0.067             NA          0.539
## Offshore.South   0.076       -0.00054             NA
## 
## 
## $null.dist
## NULL</code></pre>
<p>Both overall and pairwise tests can be conducted at once with <em>popStructTest()</em>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">popStruct &lt;-<span class="st"> </span><span class="kw">popStructTest</span>(msats, <span class="dt">stats =</span> <span class="kw">c</span>(<span class="st">&quot;fst&quot;</span>, <span class="st">&quot;fst.prime&quot;</span>), <span class="dt">nrep =</span> <span class="dv">1000</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">popStruct</a></code></pre></div>
<pre><code>## $overall
## $overall$strata.freq
## 
##        Coastal Offshore.North Offshore.South 
##             68             40             18 
## 
## $overall$result
##      estimate p.val
## Fst      0.11 0.001
## F'st     0.49 0.001
## 
## $overall$null.dist
## NULL
## 
## 
## $pairwise
## $pairwise$result
##                                                  strata.1       strata.2 n.1
## Coastal (68) v. Offshore.North (40)               Coastal Offshore.North  68
## Coastal (68) v. Offshore.South (18)               Coastal Offshore.South  68
## Offshore.North (40) v. Offshore.South (18) Offshore.North Offshore.South  40
##                                            n.2     Fst Fst.p.val    F'st
## Coastal (68) v. Offshore.North (40)         40  0.1308     0.001  0.5117
## Coastal (68) v. Offshore.South (18)         18  0.1552     0.001  0.5902
## Offshore.North (40) v. Offshore.South (18)  18 -0.0012     0.534 -0.0099
##                                            F'st.p.val
## Coastal (68) v. Offshore.North (40)             0.001
## Coastal (68) v. Offshore.South (18)             0.001
## Offshore.North (40) v. Offshore.South (18)      0.535
## 
## $pairwise$pair.mat
## $pairwise$pair.mat$Fst
##                Coastal Offshore.North Offshore.South
## Coastal             NA         0.0010          0.001
## Offshore.North    0.13             NA          0.534
## Offshore.South    0.16        -0.0012             NA
## 
## $pairwise$pair.mat$`F'st`
##                Coastal Offshore.North Offshore.South
## Coastal             NA         0.0010          0.001
## Offshore.North    0.51             NA          0.535
## Offshore.South    0.59        -0.0099             NA
## 
## 
## $pairwise$null.dist
## NULL</code></pre>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
