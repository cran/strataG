<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Eric Archer" />

<meta name="date" content="2020-02-23" />

<title>Creating and Manipulating gtypes Objects</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Creating and Manipulating gtypes Objects</h1>
<h4 class="author">Eric Archer</h4>
<h4 class="date">2020-02-23</h4>



<div id="raw-data" class="section level2">
<h2>Raw data</h2>
<p>It is easiest to load raw genotype data from the disk if it is available as a text file, usually in comma-delimited (.csv) format. The standard R functions <em>read.table</em> or <em>read.csv</em> can be used to accomplish this. However, in <em>strataG</em>, the <em>readGenData</em> function has been provided for .csv files, which is a wrapper for <em>read.csv</em> that sets commonly used values for missing data and removes blank lines.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">gen.data &lt;-<span class="st"> </span><span class="kw">readGenData</span>(<span class="st">&quot;msats.csv&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in data.table::fread(file = file, header = TRUE, na.strings =
## na.strings, : na.strings[4]==&quot; &quot; consists only of whitespace, ignoring.
## strip.white==TRUE (default) and &quot;&quot; is present in na.strings, so any number of
## spaces in string columns will already be read as &lt;NA&gt;.</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">str</span>(gen.data)</a></code></pre></div>
<pre><code>## 'data.frame':    126 obs. of  12 variables:
##  $ ids    : chr  &quot;4495&quot; &quot;4496&quot; &quot;4498&quot; &quot;5814&quot; ...
##  $ strata : chr  &quot;Offshore.North&quot; &quot;Offshore.North&quot; &quot;Offshore.North&quot; &quot;Offshore.North&quot; ...
##  $ D11t.1 : chr  &quot;133&quot; &quot;137&quot; &quot;133&quot; &quot;135&quot; ...
##  $ D11t.2 : chr  &quot;133&quot; &quot;141&quot; &quot;133&quot; &quot;139&quot; ...
##  $ EV37.1 : chr  NA NA &quot;220&quot; &quot;210&quot; ...
##  $ EV37.2 : chr  NA NA &quot;220&quot; &quot;226&quot; ...
##  $ EV94.1 : chr  NA &quot;243&quot; &quot;245&quot; &quot;251&quot; ...
##  $ EV94.2 : chr  NA &quot;251&quot; &quot;265&quot; &quot;265&quot; ...
##  $ Ttr11.1: chr  &quot;211&quot; NA &quot;209&quot; &quot;209&quot; ...
##  $ Ttr11.2: chr  &quot;211&quot; NA &quot;211&quot; &quot;209&quot; ...
##  $ Ttr34.1: chr  &quot;185&quot; &quot;189&quot; &quot;189&quot; &quot;185&quot; ...
##  $ Ttr34.2: chr  &quot;191&quot; &quot;189&quot; &quot;189&quot; &quot;187&quot; ...
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;</code></pre>
<p>For sequence data stored in FASTA format, the <em>read.fasta</em> function is available, which is a wrapper for the <em>read.dna</em> function in the <em>ape</em> package with standard FASTA arguments set. This will create a DNAbin object in the workspace:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">fname &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/dolph.seqs.fasta&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;strataG&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">read.fasta</span>(fname) </a>
<a class="sourceLine" id="cb5-3" data-line-number="3">x</a></code></pre></div>
<pre><code>## 126 DNA sequences in binary format stored in a list.
## 
## All sequences of same length: 402 
## 
## Labels:
## 4495
## 4496
## 4498
## 5814
## 5815
## 5816
## ...
## 
## Base composition:
##     a     c     g     t 
## 0.301 0.229 0.129 0.341 
## (Total: 50.65 kb)</code></pre>
<p>For sequences stored in other formats, <em>read.dna</em> should be used directly.</p>
</div>
<div id="construction" class="section level2">
<h2>Construction</h2>
<p>For most functions in <em>strataG</em>, you will need to load your data into a <em>gtypes</em> object. A <em>gtypes</em> object is an R S4 class with several slots that are fully described in <code>?gtypes</code>.<br />
The easiest way to create a <em>gtypes</em> object is with the <em>df2gtypes()</em> function. This function assumes that you have a matrix or data.frame with columns for individual ids, stratification, and locus data. You then specify the columns in the data.frame where this information can be found. <em>df2gtypes()</em> can be used for data with multiple alleles per locus, like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># create a single data.frame with the msat data and stratification</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">msats.merge &lt;-<span class="st"> </span><span class="kw">merge</span>(dolph.strata, dolph.msats, <span class="dt">all.y =</span> <span class="ot">TRUE</span>, <span class="dt">description =</span> <span class="kw">date</span>())</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw">str</span>(msats.merge)</a></code></pre></div>
<pre><code>## 'data.frame':    126 obs. of  14 variables:
##  $ id     : chr  &quot;18650&quot; &quot;18651&quot; &quot;18652&quot; &quot;18653&quot; ...
##  $ dLoop  : chr  &quot;Hap.06&quot; &quot;Hap.14&quot; &quot;Hap.23&quot; &quot;Hap.24&quot; ...
##  $ broad  : chr  &quot;Offshore&quot; &quot;Offshore&quot; &quot;Offshore&quot; &quot;Offshore&quot; ...
##  $ fine   : chr  &quot;Offshore.South&quot; &quot;Offshore.South&quot; &quot;Offshore.South&quot; &quot;Offshore.South&quot; ...
##  $ D11t.1 : chr  &quot;131&quot; &quot;137&quot; &quot;131&quot; &quot;133&quot; ...
##  $ D11t.2 : chr  &quot;133&quot; &quot;143&quot; &quot;133&quot; &quot;139&quot; ...
##  $ EV37.1 : chr  &quot;212&quot; &quot;200&quot; &quot;212&quot; &quot;202&quot; ...
##  $ EV37.2 : chr  &quot;222&quot; &quot;228&quot; &quot;218&quot; &quot;220&quot; ...
##  $ EV94.1 : chr  &quot;263&quot; &quot;249&quot; &quot;249&quot; &quot;229&quot; ...
##  $ EV94.2 : chr  &quot;265&quot; &quot;251&quot; &quot;251&quot; &quot;245&quot; ...
##  $ Ttr11.1: chr  &quot;197&quot; &quot;197&quot; &quot;211&quot; &quot;197&quot; ...
##  $ Ttr11.2: chr  &quot;209&quot; &quot;197&quot; &quot;213&quot; &quot;215&quot; ...
##  $ Ttr34.1: chr  &quot;185&quot; &quot;185&quot; &quot;185&quot; &quot;189&quot; ...
##  $ Ttr34.2: chr  &quot;187&quot; &quot;187&quot; &quot;191&quot; &quot;195&quot; ...</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># create the gtypes object</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">msats.fine &lt;-<span class="st"> </span><span class="kw">df2gtypes</span>(msats.merge, <span class="dt">ploidy =</span> <span class="dv">2</span>, <span class="dt">id.col =</span> <span class="dv">1</span>, <span class="dt">strata.col =</span> <span class="dv">3</span>, <span class="dt">loc.col =</span> <span class="dv">5</span>)</a></code></pre></div>
<p>…or for haploid data, like this:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">data</span>(dolph.seqs)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">seq.df &lt;-<span class="st"> </span>dolph.strata[ <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;broad&quot;</span>, <span class="st">&quot;id&quot;</span>)]</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="kw">colnames</span>(seq.df)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;D-loop&quot;</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">dl.g &lt;-<span class="st"> </span><span class="kw">df2gtypes</span>(seq.df, <span class="dt">ploidy =</span> <span class="dv">1</span>, <span class="dt">sequences =</span> dolph.seqs)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">dl.g</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; gtypes created on 2020-02-23 16:30:25 &gt;&gt;&gt;
## 
## Contents: 126 samples, 1 locus, 2 strata
## 
## Strata summary:
##    stratum num.ind num.missing num.haplotypes
## 1  Coastal      68           0             68
## 2 Offshore      58           0             58
## 
## Sequence summary:
##    locus num.seqs mean.length mean.num.ns mean.num.indels
## 1 D-loop      126         402           0               0</code></pre>
<p>Note that since each sequence in <em>dolph.seqs</em> is for a given individual, the <em>num.ind</em> and <em>num.haplotypes</em> values are the same for both strata. In order to convert the sequences to unique haplotypes, use the <em>labelHaplotypes()</em> function:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">dl.haps &lt;-<span class="st"> </span><span class="kw">labelHaplotypes</span>(dl.g)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">dl.haps</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; gtypes created on 2020-02-23 16:30:25 &gt;&gt;&gt;
## 
## Contents: 126 samples, 1 locus, 2 strata
## Other info: haps.unassigned
## 
## Strata summary:
##    stratum num.ind num.missing num.haplotypes
## 1  Coastal      68           0              5
## 2 Offshore      58           0             29
## 
## Sequence summary:
##    locus num.seqs mean.length mean.num.ns mean.num.indels
## 1 D-loop       33         402           0               0</code></pre>
<div id="sequence2gtypes---convert-dna-sequences" class="section level3">
<h3><em>sequence2gtypes</em> - Convert DNA sequences</h3>
<p>The <em>sequence2gtypes()</em> function creates an unstratified <em>gtype</em> object with just a set of DNA sequences:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">data</span>(dolph.haps)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">haps.g &lt;-<span class="st"> </span><span class="kw">sequence2gtypes</span>(dolph.haps)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">haps.g</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; gtypes created on 2020-02-23 16:30:26 &gt;&gt;&gt;
## 
## Contents: 33 samples, 1 locus, 1 stratum
## 
## Strata summary:
##   stratum num.ind num.missing num.haplotypes
## 1 Default      33           0             33
## 
## Sequence summary:
##   locus num.seqs mean.length mean.num.ns mean.num.indels
## 1 gene1       33         402           0               0</code></pre>
<p>If you have a vector that identifies strata designations for the sequences, that can be supplied as well:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># extract and name the stratification scheme</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">strata &lt;-<span class="st"> </span>dolph.strata<span class="op">$</span>fine</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw">names</span>(strata) &lt;-<span class="st"> </span>dolph.strata<span class="op">$</span>ids</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co"># create the gtypes object</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">dloop.fine &lt;-<span class="st"> </span><span class="kw">sequence2gtypes</span>(dolph.seqs, strata, <span class="dt">seq.names =</span> <span class="st">&quot;dLoop&quot;</span>,</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">  <span class="dt">description =</span> <span class="st">&quot;dLoop: fine-scale stratification&quot;</span>)</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">dloop.fine</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; dLoop: fine-scale stratification &gt;&gt;&gt;
## 
## Contents: 126 samples, 1 locus, 3 strata
## 
## Strata summary:
##          stratum num.ind num.missing num.haplotypes
## 1        Coastal      68           0             68
## 2 Offshore.North      40           0             40
## 3 Offshore.South      18           0             18
## 
## Sequence summary:
##   locus num.seqs mean.length mean.num.ns mean.num.indels
## 1 dLoop      126         402           0               0</code></pre>
<p>Note that stratification is generally provided for individuals, thus if you want to stratify the resulting <em>gtypes</em> object from <em>sequence2gtypes()</em>, one sequence for each individual should be provided, rather than just a set of unique haplotypes.</p>
</div>
<div id="conversions-from-other-packages." class="section level3">
<h3>Conversions from other packages.</h3>
<p>THere are conversion functions for data objects from several other popular packages in R, such as <em>adegenet</em>(genind), <em>pegas</em>(loci), and <em>phangorn</em>(phydat).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">library</span>(adegenet)</a></code></pre></div>
<pre><code>## Loading required package: ade4</code></pre>
<pre><code>## 
##    /// adegenet 2.1.2 is loaded ////////////
## 
##    &gt; overview: '?adegenet'
##    &gt; tutorials/doc/questions: 'adegenetWeb()' 
##    &gt; bug reports/feature requests: adegenetIssues()</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># from example(df2genind)</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">locusA=</span><span class="kw">c</span>(<span class="st">&quot;11&quot;</span>,<span class="st">&quot;11&quot;</span>,<span class="st">&quot;12&quot;</span>,<span class="st">&quot;32&quot;</span>),</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">                 <span class="dt">locusB=</span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="st">&quot;34&quot;</span>,<span class="st">&quot;55&quot;</span>,<span class="st">&quot;15&quot;</span>),</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">                 <span class="dt">locusC=</span><span class="kw">c</span>(<span class="st">&quot;22&quot;</span>,<span class="st">&quot;22&quot;</span>,<span class="st">&quot;21&quot;</span>,<span class="st">&quot;22&quot;</span>))</a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="kw">row.names</span>(df) &lt;-<span class="st"> </span><span class="kw">.genlab</span>(<span class="st">&quot;genotype&quot;</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">obj &lt;-<span class="st"> </span><span class="kw">df2genind</span>(df, <span class="dt">ploidy=</span><span class="dv">2</span>, <span class="dt">ncode=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-7" data-line-number="7">obj</a></code></pre></div>
<pre><code>## /// GENIND OBJECT /////////
## 
##  // 4 individuals; 3 loci; 9 alleles; size: 6.5 Kb
## 
##  // Basic content
##    @tab:  4 x 9 matrix of allele counts
##    @loc.n.all: number of alleles per locus (range: 2-4)
##    @loc.fac: locus factor for the 9 columns of @tab
##    @all.names: list of allele names for each locus
##    @ploidy: ploidy of each individual  (range: 2-2)
##    @type:  codom
##    @call: df2genind(X = df, ncode = 1, ploidy = 2)
## 
##  // Optional content
##    - empty -</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># convert to gtypes</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">gi.g &lt;-<span class="st"> </span><span class="kw">genind2gtypes</span>(obj)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">gi.g</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; gtypes created on 2020-02-23 16:30:26 &gt;&gt;&gt;
## 
## Contents: 4 samples, 3 loci, 1 stratum
## Other info: genind
## 
## Strata summary:
##   stratum num.ind num.missing num.alleles
## 1 Default       4   0.3333333           3</code></pre>
</div>
</div>
<div id="accessor-functions" class="section level2">
<h2>Accessor functions</h2>
<p>There are several functions for getting basic information from a <em>gtypes</em> object (see <code>?accessors</code>):</p>
<ul>
<li><strong>getNumInd(g)</strong> The number of individuals.</li>
<li><strong>getNumLoci(g)</strong> The number of loci.</li>
<li><strong>getNumStrata(g)</strong> The number of strata in the current scheme.</li>
<li><strong>getIndNames(g)</strong> The names of the individuals.</li>
<li><strong>getLociNames(g)</strong> The names of the loci or genes.</li>
<li><strong>getStrataNames(g)</strong> The names of the strata in the current scheme.</li>
<li><strong>getPloidy(g)</strong> The ploidy of each locus.</li>
<li><strong>getStrata(g)</strong> The current strata to which each individual belongs.</li>
<li><strong>getSchemes(g)</strong> A data frame of potential stratification schemes.</li>
<li><strong>getSequences(g)</strong> The sequences stored in a haploid object.</li>
<li><strong>getDescription(g)</strong> The text description of the object.</li>
<li><strong>getOther(g)</strong> The list used to store other information about the object.</li>
</ul>
<p>Some functions are available for modifying values in the object as well, such as:</p>
<ul>
<li><strong>setStrata(g)</strong> Replace the vector of strata assignments.</li>
<li><strong>setSchemes(g)</strong> Replace the data.frame of potential stratification schemes.</li>
<li><strong>setDescription(g)</strong> Replace the label describing the object.</li>
<li><strong>setOther(g)</strong> Replace the optional data stored in the @other slot.</li>
</ul>
</div>
<div id="subsettingindexing" class="section level2">
<h2>Subsetting/Indexing</h2>
<p>A <em>gtypes</em> object can be subset using the standard R ‘[’ indexing operation, with three slots: [i, j, k]. The first (i) specifies the desired individuals, the second (j) is the loci to return, and the third (k) is the strata. All standard R indexing operations involving numerical, character, or logical vectors work for each argument. For example, to return 10 random individuals:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">sub.msats &lt;-<span class="st"> </span>msats.fine[<span class="kw">sample</span>(<span class="kw">getNumInd</span>(msats.fine), <span class="dv">10</span>), , ]</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">sub.msats</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; gtypes created on 2020-02-23 16:30:25 &gt;&gt;&gt;
## 
## Contents: 10 samples, 5 loci, 2 strata
## 
## Strata summary:
##    stratum num.ind num.missing num.alleles
## 1  Coastal       5           0         3.4
## 2 Offshore       5           0         6.4</code></pre>
<p>…or to return specific loci:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">sub.msats &lt;-<span class="st"> </span>sub.msats[, <span class="kw">c</span>(<span class="st">&quot;D11t&quot;</span>, <span class="st">&quot;EV37&quot;</span>, <span class="st">&quot;TV7&quot;</span>), ]</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">sub.msats</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; gtypes created on 2020-02-23 16:30:25 &gt;&gt;&gt;
## 
## Contents: 10 samples, 2 loci, 2 strata
## 
## Strata summary:
##    stratum num.ind num.missing num.alleles
## 1  Coastal       5           0         2.5
## 2 Offshore       5           0         6.5</code></pre>
<p>…or some loci in a specific stratum:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">sub.msats &lt;-<span class="st"> </span>msats.fine[, <span class="kw">c</span>(<span class="st">&quot;Ttr11&quot;</span>, <span class="st">&quot;D11t&quot;</span>), <span class="st">&quot;Coastal&quot;</span>]</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">sub.msats</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; gtypes created on 2020-02-23 16:30:25 &gt;&gt;&gt;
## 
## Contents: 68 samples, 2 loci, 1 stratum
## 
## Strata summary:
##   stratum num.ind num.missing num.alleles
## 1 Coastal      68         0.5         3.5</code></pre>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>Several functions have been defined for <em>gtypes</em>, that provide summaries for individuals (<code>summarizeInds()</code>), loci (<code>summarizeLoci()</code>), and sequences (<code>summarizeSeqs()</code>):</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">summarizeLoci</span>(msats.fine)</a></code></pre></div>
<pre><code>##   locus num.genotyped num.missing prop.genotyped num.alleles allelic.richness
## 1  D11t           125           1      0.9920635          12       0.09600000
## 2  EV37           119           7      0.9444444          22       0.18487395
## 3  EV94           125           1      0.9920635          15       0.12000000
## 4 Ttr11           125           1      0.9920635           9       0.07200000
## 5 Ttr34           126           0      1.0000000          10       0.07936508
##   prop.unique.alleles exptd.het obsvd.het
## 1          0.03200000 0.7468273 0.6984127
## 2          0.02521008 0.8270751 0.6587302
## 3          0.01600000 0.8304900 0.7698413
## 4          0.02400000 0.7953414 0.6984127
## 5          0.01587302 0.8144248 0.6984127</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">summarizeInds</span>(msats.fine)</a></code></pre></div>
<pre><code>##        id  stratum num.loci.genotyped num.loci.missing.genotypes
## 1   23945  Coastal                  5                          0
## 2   25503  Coastal                  5                          0
## 3   25509  Coastal                  5                          0
## 4   40915  Coastal                  5                          0
## 5   40916  Coastal                  4                          1
## 6   41538  Coastal                  5                          0
## 7   41539  Coastal                  5                          0
## 8   41540  Coastal                  5                          0
## 9   41578  Coastal                  5                          0
## 10  41579  Coastal                  4                          1
## 11  41819  Coastal                  5                          0
## 12  41820  Coastal                  5                          0
## 13  41821  Coastal                  5                          0
## 14  41822  Coastal                  5                          0
## 15  42192  Coastal                  4                          1
## 16  42193  Coastal                  4                          1
## 17  44718  Coastal                  5                          0
## 18  44719  Coastal                  5                          0
## 19  44720  Coastal                  5                          0
## 20  44721  Coastal                  5                          0
## 21  45229  Coastal                  5                          0
## 22  45230  Coastal                  5                          0
## 23  45231  Coastal                  5                          0
## 24  45232  Coastal                  5                          0
## 25  45233  Coastal                  5                          0
## 26  45234  Coastal                  5                          0
## 27  45236  Coastal                  5                          0
## 28  45237  Coastal                  4                          1
## 29  49095  Coastal                  5                          0
## 30  51981  Coastal                  4                          1
## 31  51982  Coastal                  5                          0
## 32  78033  Coastal                  5                          0
## 33  78034  Coastal                  5                          0
## 34  78035  Coastal                  5                          0
## 35  78036  Coastal                  5                          0
## 36  78037  Coastal                  5                          0
## 37  78038  Coastal                  5                          0
## 38  78039  Coastal                  5                          0
## 39  78040  Coastal                  5                          0
## 40  78041  Coastal                  5                          0
## 41  78042  Coastal                  5                          0
## 42  78043  Coastal                  5                          0
## 43  78044  Coastal                  5                          0
## 44  78045  Coastal                  5                          0
## 45  78046  Coastal                  5                          0
## 46  78047  Coastal                  5                          0
## 47  78048  Coastal                  5                          0
## 48  78049  Coastal                  5                          0
## 49  78050  Coastal                  5                          0
## 50  78051  Coastal                  5                          0
## 51  78052  Coastal                  5                          0
## 52  78053  Coastal                  5                          0
## 53  78054  Coastal                  5                          0
## 54  78055  Coastal                  5                          0
## 55  78056  Coastal                  5                          0
## 56  78057  Coastal                  5                          0
## 57  78058  Coastal                  5                          0
## 58  78059  Coastal                  5                          0
## 59  78060  Coastal                  5                          0
## 60  78061  Coastal                  5                          0
## 61  78062  Coastal                  5                          0
## 62  78063  Coastal                  5                          0
## 63  78064  Coastal                  5                          0
## 64  78065  Coastal                  5                          0
## 65  78066  Coastal                  5                          0
## 66  78067  Coastal                  5                          0
## 67  78068  Coastal                  5                          0
## 68  78069  Coastal                  5                          0
## 69  18650 Offshore                  5                          0
## 70  18651 Offshore                  5                          0
## 71  18652 Offshore                  5                          0
## 72  18653 Offshore                  5                          0
## 73  18654 Offshore                  5                          0
## 74  18655 Offshore                  5                          0
## 75  23792 Offshore                  5                          0
## 76  23793 Offshore                  5                          0
## 77  23794 Offshore                  5                          0
## 78  23801 Offshore                  5                          0
## 79  25182 Offshore                  5                          0
## 80  25184 Offshore                  5                          0
## 81  25185 Offshore                  5                          0
## 82  25186 Offshore                  5                          0
## 83  25469 Offshore                  5                          0
## 84  25470 Offshore                  5                          0
## 85  25471 Offshore                  5                          0
## 86  26304 Offshore                  5                          0
## 87  26305 Offshore                  5                          0
## 88  26310 Offshore                  5                          0
## 89  26316 Offshore                  5                          0
## 90  26317 Offshore                  5                          0
## 91  26318 Offshore                  5                          0
## 92  26320 Offshore                  5                          0
## 93  31888 Offshore                  5                          0
## 94  41757 Offshore                  5                          0
## 95  41758 Offshore                  5                          0
## 96  41759 Offshore                  5                          0
## 97   4495 Offshore                  3                          2
## 98   4496 Offshore                  3                          2
## 99   4498 Offshore                  5                          0
## 100 50742 Offshore                  5                          0
## 101 50743 Offshore                  5                          0
## 102 50744 Offshore                  5                          0
## 103 50745 Offshore                  5                          0
## 104 50746 Offshore                  5                          0
## 105 51382 Offshore                  5                          0
## 106 51383 Offshore                  5                          0
## 107 51384 Offshore                  5                          0
## 108  5814 Offshore                  5                          0
## 109  5815 Offshore                  5                          0
## 110  5816 Offshore                  5                          0
## 111  5817 Offshore                  5                          0
## 112  5818 Offshore                  5                          0
## 113  6151 Offshore                  5                          0
## 114  6153 Offshore                  5                          0
## 115  6290 Offshore                  5                          0
## 116 74959 Offshore                  5                          0
## 117 74960 Offshore                  5                          0
## 118 74961 Offshore                  5                          0
## 119 74962 Offshore                  5                          0
## 120 74963 Offshore                  5                          0
## 121 74964 Offshore                  5                          0
## 122 74965 Offshore                  5                          0
## 123 74966 Offshore                  5                          0
## 124 78530 Offshore                  5                          0
## 125 78531 Offshore                  5                          0
## 126 78532 Offshore                  5                          0
##     pct.loci.missing.genotypes pct.loci.homozygous
## 1                          0.0                 0.4
## 2                          0.0                 0.6
## 3                          0.0                 0.8
## 4                          0.0                 0.6
## 5                          0.2                 0.0
## 6                          0.0                 0.4
## 7                          0.0                 0.6
## 8                          0.0                 0.0
## 9                          0.0                 0.0
## 10                         0.2                 0.2
## 11                         0.0                 0.0
## 12                         0.0                 0.2
## 13                         0.0                 0.8
## 14                         0.0                 0.6
## 15                         0.2                 0.4
## 16                         0.2                 0.0
## 17                         0.0                 0.6
## 18                         0.0                 0.2
## 19                         0.0                 0.2
## 20                         0.0                 0.2
## 21                         0.0                 0.4
## 22                         0.0                 0.0
## 23                         0.0                 0.6
## 24                         0.0                 0.6
## 25                         0.0                 0.2
## 26                         0.0                 0.2
## 27                         0.0                 0.6
## 28                         0.2                 0.2
## 29                         0.0                 0.4
## 30                         0.2                 0.6
## 31                         0.0                 0.4
## 32                         0.0                 0.0
## 33                         0.0                 0.0
## 34                         0.0                 0.2
## 35                         0.0                 1.0
## 36                         0.0                 0.4
## 37                         0.0                 0.2
## 38                         0.0                 0.8
## 39                         0.0                 0.0
## 40                         0.0                 0.4
## 41                         0.0                 0.0
## 42                         0.0                 0.2
## 43                         0.0                 0.6
## 44                         0.0                 0.2
## 45                         0.0                 0.4
## 46                         0.0                 0.4
## 47                         0.0                 0.0
## 48                         0.0                 0.2
## 49                         0.0                 0.4
## 50                         0.0                 0.4
## 51                         0.0                 0.6
## 52                         0.0                 0.4
## 53                         0.0                 0.2
## 54                         0.0                 0.2
## 55                         0.0                 0.8
## 56                         0.0                 0.4
## 57                         0.0                 0.2
## 58                         0.0                 0.2
## 59                         0.0                 0.8
## 60                         0.0                 0.6
## 61                         0.0                 0.4
## 62                         0.0                 0.4
## 63                         0.0                 0.2
## 64                         0.0                 0.6
## 65                         0.0                 0.4
## 66                         0.0                 0.6
## 67                         0.0                 0.4
## 68                         0.0                 0.4
## 69                         0.0                 0.0
## 70                         0.0                 0.2
## 71                         0.0                 0.0
## 72                         0.0                 0.0
## 73                         0.0                 0.2
## 74                         0.0                 0.0
## 75                         0.0                 0.0
## 76                         0.0                 0.2
## 77                         0.0                 0.2
## 78                         0.0                 0.0
## 79                         0.0                 0.0
## 80                         0.0                 0.4
## 81                         0.0                 0.0
## 82                         0.0                 0.4
## 83                         0.0                 0.0
## 84                         0.0                 0.4
## 85                         0.0                 0.0
## 86                         0.0                 0.2
## 87                         0.0                 0.6
## 88                         0.0                 0.2
## 89                         0.0                 0.2
## 90                         0.0                 0.2
## 91                         0.0                 0.2
## 92                         0.0                 0.0
## 93                         0.0                 0.0
## 94                         0.0                 0.4
## 95                         0.0                 0.2
## 96                         0.0                 0.2
## 97                         0.4                 0.4
## 98                         0.4                 0.2
## 99                         0.0                 0.6
## 100                        0.0                 0.6
## 101                        0.0                 0.2
## 102                        0.0                 0.0
## 103                        0.0                 0.2
## 104                        0.0                 0.2
## 105                        0.0                 0.6
## 106                        0.0                 0.0
## 107                        0.0                 0.6
## 108                        0.0                 0.2
## 109                        0.0                 0.6
## 110                        0.0                 0.0
## 111                        0.0                 0.2
## 112                        0.0                 0.0
## 113                        0.0                 0.0
## 114                        0.0                 0.0
## 115                        0.0                 0.0
## 116                        0.0                 0.0
## 117                        0.0                 0.4
## 118                        0.0                 0.0
## 119                        0.0                 0.0
## 120                        0.0                 0.4
## 121                        0.0                 0.0
## 122                        0.0                 0.0
## 123                        0.0                 0.2
## 124                        0.0                 0.2
## 125                        0.0                 0.4
## 126                        0.0                 0.0</code></pre>
</div>
<div id="stratifying-samples" class="section level2">
<h2>Stratifying samples</h2>
<p>You can specify the stratification scheme when creating a <em>gtypes</em> object as in the examples above. Once a <em>gtypes</em> object has been created, you can also change the stratification scheme by either supplying a new vector for the @strata slot:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co"># randomly stratify individuals to two populations</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2">msats &lt;-<span class="st"> </span>msats.g</a>
<a class="sourceLine" id="cb35-3" data-line-number="3">new.strata &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Pop1&quot;</span>, <span class="st">&quot;Pop2&quot;</span>), <span class="kw">getNumInd</span>(msats), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="kw">names</span>(new.strata) &lt;-<span class="st"> </span><span class="kw">getIndNames</span>(msats)</a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="kw">setStrata</span>(msats) &lt;-<span class="st"> </span>new.strata</a>
<a class="sourceLine" id="cb35-6" data-line-number="6">msats</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; dolphin msats &gt;&gt;&gt;
## 
## Contents: 126 samples, 5 loci, 2 strata
## Stratification schemes: broad, fine
## 
## Strata summary:
##   stratum num.ind num.missing num.alleles
## 1    Pop1      65           1        12.2
## 2    Pop2      61           1        11.6</code></pre>
<p>or, if there is a stratification scheme data.frame in the @schemes slot, you can use the <em>stratify</em> function to choose a stratification scheme:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co"># choose &quot;broad&quot; stratification scheme</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2">msats &lt;-<span class="st"> </span><span class="kw">stratify</span>(msats, <span class="st">&quot;broad&quot;</span>)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">msats</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; dolphin msats &gt;&gt;&gt;
## 
## Contents: 126 samples, 5 loci, 2 strata
## Stratification schemes: broad, fine
## 
## Strata summary:
##    stratum num.ind num.missing num.alleles
## 1  Coastal      68         1.2         4.8
## 2 Offshore      58         0.8        13.6</code></pre>
<p>You can update the @schemes slot with data.frame like this:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">new.schemes &lt;-<span class="st"> </span><span class="kw">getSchemes</span>(msats)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">new.schemes<span class="op">$</span>ran.pop &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Pop5&quot;</span>, <span class="st">&quot;Pop6&quot;</span>), <span class="kw">getNumInd</span>(msats), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="kw">setSchemes</span>(msats) &lt;-<span class="st"> </span>new.schemes</a></code></pre></div>
<p>NOTE: Filling or changing the @schemes slot does not affect the current stratification of the samples. You must then select a new stratification scheme or fill the @strata slot as above.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">stratify</span>(msats, <span class="st">&quot;ran.pop&quot;</span>)</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; dolphin msats &gt;&gt;&gt;
## 
## Contents: 126 samples, 5 loci, 2 strata
## Stratification schemes: broad, fine, ran.pop
## 
## Strata summary:
##   stratum num.ind num.missing num.alleles
## 1    Pop5      59         0.8        11.6
## 2    Pop6      67         1.2        12.2</code></pre>
<p>If some samples should be unstratified (excluded from any stratified analyses), they should have NAs in the appropriate position in the @strata slot. For example:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co"># unstratify a random 10 samples</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">getStrata</span>(msats)</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">x[<span class="kw">sample</span>(<span class="kw">getIndNames</span>(msats), <span class="dv">10</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4">msats</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; dolphin msats &gt;&gt;&gt;
## 
## Contents: 126 samples, 5 loci, 2 strata
## Stratification schemes: broad, fine, ran.pop
## 
## Strata summary:
##    stratum num.ind num.missing num.alleles
## 1  Coastal      68         1.2         4.8
## 2 Offshore      58         0.8        13.6</code></pre>
<p>You can also randomly permute the current stratification scheme using the <em>permuteStrata()</em> function like this:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">msats &lt;-<span class="st"> </span><span class="kw">stratify</span>(msats, <span class="st">&quot;fine&quot;</span>)</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="co"># original</span></a>
<a class="sourceLine" id="cb44-4" data-line-number="4">msats</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; dolphin msats &gt;&gt;&gt;
## 
## Contents: 126 samples, 5 loci, 3 strata
## Stratification schemes: broad, fine, ran.pop
## 
## Strata summary:
##          stratum num.ind num.missing num.alleles
## 1        Coastal      68         1.2         4.8
## 2 Offshore.North      40         0.8        12.6
## 3 Offshore.South      18         0.0        11.0</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co"># permuted</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">ran.msats &lt;-<span class="st"> </span><span class="kw">permuteStrata</span>(msats)</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">ran.msats</a></code></pre></div>
<pre><code>## 
## &lt;&lt;&lt; dolphin msats &gt;&gt;&gt;
## 
## Contents: 126 samples, 5 loci, 3 strata
## Stratification schemes: broad, fine, ran.pop
## 
## Strata summary:
##          stratum num.ind num.missing num.alleles
## 1        Coastal      68         1.4        12.0
## 2 Offshore.North      40         0.4        11.0
## 3 Offshore.South      18         0.2         7.2</code></pre>
<p>NOTE: Only samples assigned to strata are permuted with <em>permuteStrata</em>. Those not assigned (NAs) remain unassigned.</p>
</div>
<div id="exporting" class="section level2">
<h2>Exporting</h2>
<p>The allelic data in a <em>gtypes</em> object can be converted back to a matrix or data frame with <em>as.matrix()</em> and <em>as.data.frame()</em>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">gen.mat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(msats)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="kw">head</span>(gen.mat)</a></code></pre></div>
<pre><code>##      id      stratum          D11t.1 D11t.2 EV37.1 EV37.2 EV94.1 EV94.2 Ttr11.1
## [1,] &quot;18650&quot; &quot;Offshore.South&quot; &quot;131&quot;  &quot;133&quot;  &quot;212&quot;  &quot;222&quot;  &quot;263&quot;  &quot;265&quot;  &quot;197&quot;  
## [2,] &quot;18651&quot; &quot;Offshore.South&quot; &quot;137&quot;  &quot;143&quot;  &quot;200&quot;  &quot;228&quot;  &quot;249&quot;  &quot;251&quot;  &quot;197&quot;  
## [3,] &quot;18652&quot; &quot;Offshore.South&quot; &quot;131&quot;  &quot;133&quot;  &quot;212&quot;  &quot;218&quot;  &quot;249&quot;  &quot;251&quot;  &quot;211&quot;  
## [4,] &quot;18653&quot; &quot;Offshore.South&quot; &quot;133&quot;  &quot;139&quot;  &quot;202&quot;  &quot;220&quot;  &quot;229&quot;  &quot;245&quot;  &quot;197&quot;  
## [5,] &quot;18654&quot; &quot;Offshore.South&quot; &quot;131&quot;  &quot;135&quot;  &quot;214&quot;  &quot;216&quot;  &quot;249&quot;  &quot;249&quot;  &quot;197&quot;  
## [6,] &quot;18655&quot; &quot;Offshore.South&quot; &quot;131&quot;  &quot;137&quot;  &quot;222&quot;  &quot;254&quot;  &quot;243&quot;  &quot;255&quot;  &quot;207&quot;  
##      Ttr11.2 Ttr34.1 Ttr34.2
## [1,] &quot;209&quot;   &quot;185&quot;   &quot;187&quot;  
## [2,] &quot;197&quot;   &quot;185&quot;   &quot;187&quot;  
## [3,] &quot;213&quot;   &quot;185&quot;   &quot;191&quot;  
## [4,] &quot;215&quot;   &quot;189&quot;   &quot;195&quot;  
## [5,] &quot;211&quot;   &quot;185&quot;   &quot;187&quot;  
## [6,] &quot;211&quot;   &quot;183&quot;   &quot;193&quot;</code></pre>
<p>By default, this function splits each allele into its own column. One can make a matrix with one locus per column and alleles separated by a specified character by setting the <em>one.col</em> argument to <em>TRUE</em>:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">gen.mat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(msats, <span class="dt">one.col =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="kw">head</span>(gen.mat)</a></code></pre></div>
<pre><code>##      id      stratum          D11t      EV37      EV94      Ttr11     Ttr34    
## [1,] &quot;18650&quot; &quot;Offshore.South&quot; &quot;131/133&quot; &quot;212/222&quot; &quot;263/265&quot; &quot;197/209&quot; &quot;185/187&quot;
## [2,] &quot;18651&quot; &quot;Offshore.South&quot; &quot;137/143&quot; &quot;200/228&quot; &quot;249/251&quot; &quot;197/197&quot; &quot;185/187&quot;
## [3,] &quot;18652&quot; &quot;Offshore.South&quot; &quot;131/133&quot; &quot;212/218&quot; &quot;249/251&quot; &quot;211/213&quot; &quot;185/191&quot;
## [4,] &quot;18653&quot; &quot;Offshore.South&quot; &quot;133/139&quot; &quot;202/220&quot; &quot;229/245&quot; &quot;197/215&quot; &quot;189/195&quot;
## [5,] &quot;18654&quot; &quot;Offshore.South&quot; &quot;131/135&quot; &quot;214/216&quot; &quot;249/249&quot; &quot;197/211&quot; &quot;185/187&quot;
## [6,] &quot;18655&quot; &quot;Offshore.South&quot; &quot;131/137&quot; &quot;222/254&quot; &quot;243/255&quot; &quot;207/211&quot; &quot;183/193&quot;</code></pre>
<p>The contents of a <em>gtypes</em> object can be written to a file with the <em>writeGtypes()</em> function. This will write a .csv file with the allelic information and a .fasta file for any sequence data if it exists.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
